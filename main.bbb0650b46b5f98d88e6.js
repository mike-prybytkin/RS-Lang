(()=>{"use strict";const e=".body",t=".main-wrapper",s="logout-user",i=".toast",r=".theme-icon",n="text-darken-4",a="text-lighten-2",o=["red","lighten-5"],c=["brown","lighten-1"],d="dark-theme";var l;!function(e){e.Body=".body",e.MainWrapper=".main-wrapper",e.TEXT_VARIANT=".text-variant",e.TEXT_VARIANT_CONTAINER=".text-variant-container",e.AUDIO_PLAYER=".audio-player",e.IMAGE_WORD_CONTAINER=".image-word-container",e.AUDIO_ICON_CONTAINER=".audio-icon-container",e.TEXT_ANSWER=".text-answer",e.IMAGE_WORD=".image-word",e.ImageAudio=".image-audio",e.CorrectAnswerContainer=".correct-answer-container",e.Navigation=".navigation",e.TextNavigation=".text-navigation",e.Ignorance=".ignorance",e.MistakeStatisticContainer=".mistake-statistic-container",e.SuccessStatisticContainer=".success-statistic-container",e.CountMistake=".count-mistake",e.CountSuccess=".count-success",e.StatisticWordSpan=".statistic-word-span",e.StatisticTranslateSpan=".statistic-translate-span",e.StatisticPlayAgainButton=".statistic-play-again-button",e.StatisticHomePageButton=".statistic-home-page-button",e.LevelButton=".difficulty-level",e.CorrectImageAudio=".correct-image-audio",e.SprintAudioIcon=".sprint-audio-icon",e.TextWord=".text-word",e.TextTranslate=".text-translate",e.ButtonVariant=".button-variant",e.NoVariant=".no-variant",e.YesVariant=".yes-variant",e.SprintContainer=".sprint-container",e.AudioImageContainer=".audio-image-container",e.Timer=".timer",e.Score=".score",e.MainGame=".main-game",e.CountPoints=".count-points",e.AnswerCircle=".answer-circle",e.CrossContainer=".cross-container",e.FOOTER=".footer",e.StatisticScore=".statistic-score"}(l||(l={}));const u="%7B%22%24or%22%3A%5B%7B%22userWord%22%3Anull%7D%2C%20%7B%22userWord.optional.learned%22%3Afalse%7D%5D%7D",h=class{getItemLocalStorage(e){var t;const s=null!==(t=localStorage.getItem(e))&&void 0!==t?t:"";return s?JSON.parse(s):null}setItemLocalStorage(e,t){localStorage.setItem(e,JSON.stringify(t))}removeItemLocalStorage(e){localStorage.removeItem(e)}};var g=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function a(e){try{c(i.next(e))}catch(e){n(e)}}function o(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}c((i=i.apply(e,t||[])).next())}))};const m=class{constructor(){this.baseUrl="https://rs-lang-prodaction.herokuapp.com";const e=localStorage.getItem("user");if(e){const t=JSON.parse(e);this.token=t.token,this.userId=t.userId,this.refreshToken=t.refreshToken}else this.token="",this.userId="",this.refreshToken=""}typedFetch(e,t,s,i){return g(this,void 0,void 0,(function*(){try{const r=`${this.baseUrl}/${e}`,n=this.getRequestConfig(t,i,s);if("DELETE"===t)return yield fetch(`${r}`,n),null;const a=yield fetch(`${r}`,n);return yield a.json()}catch(e){return console.log("error",t),null}}))}getRequestConfig(e,t,s){const i={body:JSON.stringify(t),headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${s}`}};switch(e){case"DELETE":return Object.assign({method:"DELETE"},i);case"POST":return Object.assign({method:"POST"},i);case"PUT":return Object.assign({method:"PUT"},i);case"GET":return Object.assign({method:"GET"},i);default:return{}}}getData(e,t){return g(this,void 0,void 0,(function*(){return yield this.typedFetch(e,"GET",t)}))}postData(e,t,s){return g(this,void 0,void 0,(function*(){return yield this.typedFetch(e,"POST",t,s)}))}putData(e,t,s){return g(this,void 0,void 0,(function*(){return yield this.typedFetch(e,"PUT",t,s)}))}deleteData(e,t){return g(this,void 0,void 0,(function*(){yield this.typedFetch(e,"DELETE",t)}))}};var v=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function a(e){try{c(i.next(e))}catch(e){n(e)}}function o(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}c((i=i.apply(e,t||[])).next())}))};const p=class extends m{createUser(e,t,s){return v(this,void 0,void 0,(function*(){const i={email:e,password:t,name:s};return yield this.postData("users",this.token,i)}))}loginUser(e,t){return v(this,void 0,void 0,(function*(){const s={email:e,password:t};return yield this.postData("signin",this.token,s)}))}getUser(){return v(this,void 0,void 0,(function*(){const e=`users/${this.userId}`;return yield this.getData(e,this.token)}))}updateUser(e,t,s){return v(this,void 0,void 0,(function*(){const i=`users/${this.userId}`,r={email:e,password:t,name:s};return yield this.putData(i,this.token,r)}))}deleteUser(){return v(this,void 0,void 0,(function*(){const e=`users/${this.userId}`;yield this.deleteData(e,this.token)}))}getNewUserTokens(){return v(this,void 0,void 0,(function*(){const e=`users/${this.userId}/tokens`,t=yield this.getData(e,this.refreshToken);return t&&(this.token=t.token,this.refreshToken=t.refreshToken),t}))}createDifficultUserWord(e){return v(this,void 0,void 0,(function*(){const t=`users/${this.userId}/words/${e}`;return yield this.postData(t,this.token,{difficulty:"true",optional:{learned:!1,successAnswersSequence:0,successAttempt:0,wrongAttempt:0}})}))}createDifficultUserWord1(e,t,s){return v(this,void 0,void 0,(function*(){const i=`users/${e}/words/${s}`;return yield this.postData(i,t,{difficulty:"true",optional:{learned:!1,successAnswersSequence:0,successAttempt:0,wrongAttempt:0}})}))}createLearnedUserWord1(e,t,s){return v(this,void 0,void 0,(function*(){const i=`users/${e}/words/${s}`;return yield this.postData(i,t,{difficulty:"false",optional:{learned:!0,successAnswersSequence:0,successAttempt:0,wrongAttempt:0}})}))}getAllUserWords1(e,t){return v(this,void 0,void 0,(function*(){const s=`users/${e}/words`;return yield this.getData(s,t)}))}getUserWord1(e,t,s){return v(this,void 0,void 0,(function*(){const i=`users/${e}/words/${s}`;return yield this.getData(i,t)}))}deleteUserWord1(e,t,s){return v(this,void 0,void 0,(function*(){const i=`users/${e}/words/${s}`;yield this.deleteData(i,t)}))}updateUserWord1(e,t,s,i,r){return v(this,void 0,void 0,(function*(){const n=`users/${e}/words/${s}`,a={difficulty:i,optional:r};return yield this.putData(n,t,a)}))}createLearnedUserWord(e){return v(this,void 0,void 0,(function*(){const t=`users/${this.userId}/words/${e}`;return yield this.postData(t,this.token,{difficulty:"false",optional:{learned:!0,successAnswersSequence:0,successAttempt:0,wrongAttempt:0}})}))}createNewUserWord(e,t){return v(this,void 0,void 0,(function*(){const s=`users/${this.userId}/words/${e}`,i={difficulty:"false",optional:t};return yield this.postData(s,this.token,i)}))}getUserWord(e){return v(this,void 0,void 0,(function*(){const t=`users/${this.userId}/words/${e}`;return yield this.getData(t,this.token)}))}getAllUserWords(){return v(this,void 0,void 0,(function*(){const e=`users/${this.userId}/words`;return yield this.getData(e,this.token)}))}updateUserWord(e,t,s){return v(this,void 0,void 0,(function*(){const i=`users/${this.userId}/words/${e}`,r={difficulty:t,optional:s};return yield this.putData(i,this.token,r)}))}deleteUserWord(e){return v(this,void 0,void 0,(function*(){const t=`users/${this.userId}/words/${e}`;yield this.deleteData(t,this.token)}))}getAggregatedWords(e,t,s){return v(this,void 0,void 0,(function*(){let i=`users/${this.userId}/aggregatedWords?group=${e}&wordsPerPage=${t}`;return s&&(i=`${i}&filter=${s}`),yield this.getData(i,this.token)}))}getAggregatedWord(e){return v(this,void 0,void 0,(function*(){const t=`users/${this.userId}/aggregatedWords/${e}`;return yield this.getData(t,this.token)}))}writeUserData(e){this.token=e.token,this.userId=e.userId,this.refreshToken=e.refreshToken}removeUserData(){this.token="",this.userId="",this.refreshToken=""}},w=class{listnerLogoButton(e){document.addEventListener("DOMContentLoaded",(()=>{document.querySelector(".switch-to-home-page").addEventListener("click",(()=>{e()}))}))}renderHomePage(){document.querySelector(t).innerHTML=this.homePageTemplate()}homePageTemplate(){return'\n    <div class="home-page-wrapper">\n      <div class="home-page">\n        <div class="home-page__title">\n          <h3 class="home-page__quote-1"><span class="dont">Don\'t</span> be an <span class="alien">alien</span> in a foreign country</h3>\n          <p class="home-page__quote-2">Не будь инопланетянином в чужой стране</p>\n        </div>\n        <img class="home-page__image" src="./assets/home-page.svg" alt="home page">\n      </div>\n      <div class="home-page-advantages">\n        <h5 class="home-page-advantages__quote">Всё, для вашего удобства</h5>\n        <ul class="advantages-list">\n          <li class="advantages-item">4000 слов</li>\n          <li class="advantages-item">2 мини-игры</li>\n          <li class="advantages-item">Статистика обучения</li>\n          <li class="advantages-item">Пользовательские настройки</li>\n        </ul>\n    </div>\n    '}};var y=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function a(e){try{c(i.next(e))}catch(e){n(e)}}function o(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}c((i=i.apply(e,t||[])).next())}))};const f=class extends m{getWords(e,t){return y(this,void 0,void 0,(function*(){const s=`words?group=${e}&page=${t}`;return yield this.getData(s,this.token)}))}getWordById(e){return y(this,void 0,void 0,(function*(){const t=`words/${e}`;return yield this.getData(t,this.token)}))}};var S=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function a(e){try{c(i.next(e))}catch(e){n(e)}}function o(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}c((i=i.apply(e,t||[])).next())}))};var b=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function a(e){try{c(i.next(e))}catch(e){n(e)}}function o(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}c((i=i.apply(e,t||[])).next())}))};var L=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function a(e){try{c(i.next(e))}catch(e){n(e)}}function o(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}c((i=i.apply(e,t||[])).next())}))};var k=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function a(e){try{c(i.next(e))}catch(e){n(e)}}function o(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}c((i=i.apply(e,t||[])).next())}))};var W=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function a(e){try{c(i.next(e))}catch(e){n(e)}}function o(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}c((i=i.apply(e,t||[])).next())}))};const A=new p,{baseUrl:x}=new m,_=new h,T=class{constructor(){this.changeStyleDifficultWord=e=>{const t=document.querySelectorAll(".word");e.forEach((e=>{t.forEach((t=>{e.wordId===t.dataset.id&&t.classList.add("word-difficult")}))}))},this.user=_.getItemLocalStorage("user")}renderPage(e){return W(this,void 0,void 0,(function*(){const t=document.querySelector(".words__wrapper"),s=document.querySelector("#card__template");t.innerHTML="";const i=document.createElement("audio");let r,n;i.classList.add("audio"),t.append(i),this.user&&(r=yield this.getUserDifficultWord(),n=yield this.getUserLearnedWord()),(yield e).forEach((e=>W(this,void 0,void 0,(function*(){const i=s.content.cloneNode(!0),a=i.querySelector(".word"),o=i.querySelector(".word__img"),c=i.querySelector(".word__text"),d=i.querySelector(".word__text-translate"),l=i.querySelector(".word__transcription"),u=i.querySelector(".word__text-meaning"),h=i.querySelector(".word__text-meaning-translate"),g=i.querySelector(".word__text-example"),m=i.querySelector(".word__text-example-translate"),v=i.querySelector(".word__audio"),p=i.querySelector(".word__hard"),w=i.querySelector(".word__studied");o.src=`${x}/${e.image}`,a.dataset.id=e.id,c.innerHTML=e.word,l.innerHTML=e.transcription,d.innerHTML=e.wordTranslate,u.innerHTML=e.textMeaning,h.innerHTML=e.textMeaningTranslate,g.innerHTML=e.textExample,m.innerHTML=e.textExampleTranslate,v.addEventListener("click",(()=>{this.playAudio([e.audio,e.audioMeaning,e.audioExample])})),w.addEventListener("click",(()=>{a.classList.contains("word-difficult")?this.updateWordFromDifficult(e.id):this.addWordInStudied(e.id)})),p.addEventListener("click",(()=>{this.addWordInDifficult(e.id)})),this.user&&(p.classList.add("word__btn_active"),w.classList.add("word__btn_active"),n.forEach((e=>{a.dataset.id===e.wordId&&a.classList.add("word-learned")})),r.forEach((e=>{a.dataset.id===e.wordId&&a.classList.add("word-difficult")}))),t.append(i)})))),this.checkPageForFamiliarity()}))}renderDifficultPage(e){return W(this,void 0,void 0,(function*(){const t=document.querySelector(".words__wrapper"),s=document.querySelector("#card__template"),i=document.querySelector(".words__wrapper");null==i||i.classList.remove("page-learned"),t.innerHTML="";const r=document.createElement("audio");r.classList.add("audio"),t.append(r),(yield e).forEach((e=>W(this,void 0,void 0,(function*(){const i=s.content.cloneNode(!0),r=i.querySelector(".word"),n=i.querySelector(".word__img"),a=i.querySelector(".word__text"),o=i.querySelector(".word__text-translate"),c=i.querySelector(".word__transcription"),d=i.querySelector(".word__text-meaning"),l=i.querySelector(".word__text-meaning-translate"),u=i.querySelector(".word__text-example"),h=i.querySelector(".word__text-example-translate"),g=i.querySelector(".word__audio"),m=i.querySelector(".word__controls"),v=document.createElement("button");v.textContent="Удалить",v.classList.add("deep-orange","word__btn","word__btn_active","word__btn_delete"),m.append(v),n.src=`${x}/${(yield e).image}`,r.dataset.id=(yield e).id,r.classList.add("word-difficult"),a.innerHTML=(yield e).word,c.innerHTML=(yield e).transcription,o.innerHTML=(yield e).wordTranslate,d.innerHTML=(yield e).textMeaning,l.innerHTML=(yield e).textMeaningTranslate,u.innerHTML=(yield e).textExample,h.innerHTML=(yield e).textExampleTranslate,g.addEventListener("click",(()=>W(this,void 0,void 0,(function*(){this.playAudio([(yield e).audio,(yield e).audioMeaning,(yield e).audioExample])})))),v.addEventListener("click",(()=>{this.deleteWordFromDifficult(String(r.dataset.id)),r.style.display="none"})),t.append(i)}))))}))}renderBaseStructure(){document.querySelector(".main-wrapper").innerHTML='\n  <div class="container">\n  <div class="controls">\n  <a class=\'group-dropdown-trigger waves-effect waves-light btn deep-orange controls__item\' href=\'#\' data-target=\'group-dropdown\'>Раздел 1</a>\n  <ul id=\'group-dropdown\' class=\'dropdown-content\'>\n  </ul>\n  <div class="page controls__item">\n    <button class="waves-effect waves-light btn deep-orange prev-btn"><</button>\n    <a class=\'page-dropdown-trigger waves-effect waves-light btn deep-orange current-page\' href=\'#\' data-target=\'page-dropdown\'>Страница 1</a>\n    <ul id=\'page-dropdown\' class=\'dropdown-content\'>\n      \n    </ul>\n    <button class="waves-effect waves-light btn deep-orange next-btn">></button>\n  </div>\n  <button class="waves-effect waves-light btn deep-orange game__btn game__btn-audiocall controls__item">Аудиовызов</button>\n  <button class="waves-effect waves-light btn deep-orange game__btn game__btn-sprint controls__item">Спринт</button>\n</div>\n  <div class="words__wrapper">\n</div></div>\n  <template id="card__template">\n  <div class="word">\n    <img alt="img" class="word__img">\n    <div class="word__content">\n    <div class="word__descr">\n    <div class="word__header">\n      <div class="word__text"></div>\n      <div class="word__transcription"></div>\n      <div class="word__text-translate"></div>\n    </div>\n    <div class="word__text-meaning"></div>\n    <div class="word__text-meaning-translate"></div>\n    <div class="word__text-example"></div>\n    <div class="word__text-example-translate"></div>\n  </div>\n  <div class="word__controls">\n    <button class="deep-orange word__audio">\n      <img src="./assets/icons/play.png" class="word__audio-img">\n    </button>\n    <button class="deep-orange word__btn word__hard">В сложные</button>\n    <button class="deep-orange word__btn word__studied">Изучено</button>\n  </div>\n</div>\n    </div>\n</template>\n<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"><\/script>'}playAudio(e){const t=document.querySelector(".audio");t.src=`${x}/${e[0]}`,t.play(),t.addEventListener("ended",(()=>{t.src===`${x}/${e[0]}`&&setTimeout((()=>{t.src=`${x}/${e[1]}`,t.play()}),300),t.src===`${x}/${e[1]}`&&setTimeout((()=>{t.src=`${x}/${e[2]}`,t.play()}),300)}))}initializeGroupDropdown(e){const t=["deep-orange lighten-4","deep-orange lighten-3","deep-orange lighten-2","deep-orange lighten-1","deep-orange","deep-orange darken-1"],s=document.querySelectorAll(".group-dropdown-trigger");M.Dropdown.init(s);const i=document.getElementById("group-dropdown");for(let s=1;s<=e;s+=1)i.innerHTML+=`<li><a href="#!" class="${t[s-1]}  white-text group__item">Раздел ${s}</a></li>`;this.user=_.getItemLocalStorage("user"),this.user&&(i.innerHTML+='<li><a href="#!" class="deep-orange darken-4 white-text group__item_difficult">Сложные слова</a></li>')}initializePageDropdown(e){const t=document.querySelectorAll(".page-dropdown-trigger");M.Dropdown.init(t);const s=document.getElementById("page-dropdown");for(let t=1;t<=e;t+=1)s.innerHTML+=`<li><a href="#!" class="deep-orange white-text page__item">Страница ${t}</a></li>`}changeControlsCaption(e,t){const s=document.querySelector(".current-page"),i=document.querySelector(".group-dropdown-trigger.btn");document.querySelector(".page").style.display="flex",i.textContent=`Раздел ${e+1}`,s.textContent=`Страница ${t+1}`,document.querySelector(".game__btn-audiocall").style.display="block",document.querySelector(".game__btn-sprint").style.display="block"}changeControlsCaptionForDifficult(){const e=document.querySelector(".page");document.querySelector(".group-dropdown-trigger.btn").textContent="Сложные слова",e.style.display="none";const t=document.querySelector(".audio");document.querySelector(".game__btn-audiocall").style.display="none",document.querySelector(".game__btn-sprint").style.display="none",t.pause()}updatePage(e,t,s){this.renderPage(s),this.changeControlsCaption(e,t),document.querySelector(".audio").pause()}checkPageForFamiliarity(){const e=document.querySelector(".words__wrapper"),t=document.querySelectorAll(".word"),s=document.querySelectorAll(".word-learned"),i=document.querySelectorAll(".word-difficult"),r=document.querySelectorAll(".game__btn");t.length===s.length+i.length?(null==e||e.classList.add("page-learned"),r.forEach((e=>{e.setAttribute("disabled","true")}))):(null==e||e.classList.remove("page-learned"),r.forEach((e=>{e.removeAttribute("disabled")})))}addWordInDifficult(e){return W(this,void 0,void 0,(function*(){(yield A.getUserWord1(this.user.userId,this.user.token,e))?console.log("Данное слово уже добавлено в сложные"):(A.createDifficultUserWord1(this.user.userId,this.user.token,e),document.querySelector(`[data-id="${e}"]`).classList.add("word-difficult"))}))}addWordInStudied(e){return W(this,void 0,void 0,(function*(){(yield A.getUserWord1(this.user.userId,this.user.token,e))?console.log("Данное слово уже добавлено в изученные"):(A.createLearnedUserWord1(this.user.userId,this.user.token,e),document.querySelector(`[data-id="${e}"]`).classList.add("word-learned"))}))}deleteWordFromDifficult(e){return W(this,void 0,void 0,(function*(){A.deleteUserWord1(this.user.userId,this.user.token,e)}))}updateWordFromDifficult(e){return W(this,void 0,void 0,(function*(){const t=yield A.getUserWord1(this.user.userId,this.user.token,e);t.optional.learned=!0,A.updateUserWord1(this.user.userId,this.user.token,e,null==t?void 0:t.difficulty,null==t?void 0:t.optional),document.querySelector(`[data-id="${e}"]`).classList.add("word-learned")}))}getUserDifficultWord(){return W(this,void 0,void 0,(function*(){const e=yield A.getAllUserWords1(this.user.userId,this.user.token),t=[];return null==e||e.forEach((e=>{e.optional.learned||t.push(e)})),t}))}getUserLearnedWord(){return W(this,void 0,void 0,(function*(){const e=yield A.getAllUserWords1(this.user.userId,this.user.token),t=[];return null==e||e.forEach((e=>{e.optional.learned&&t.push(e)})),t}))}};var P=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function a(e){try{c(i.next(e))}catch(e){n(e)}}function o(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}c((i=i.apply(e,t||[])).next())}))};(new class{constructor(){this.view=new class{constructor(){this.homePage=new w}listnerGamesButton(){const e=document.querySelectorAll(".games");this.mainWrapper=document.querySelector(t);for(let t=0;t<e.length;t+=1)e[t].addEventListener("click",(()=>{this.mainWrapper.innerHTML=this.gamePageTemplate()}))}callAudioChallengeGame(e){this.mainWrapper.addEventListener("click",(t=>{const s=t.target;(s.classList.contains("audio-challenge-game")||s.closest(".audio-challenge-game"))&&e()}))}callSprintGame(e){this.mainWrapper.addEventListener("click",(t=>{const s=t.target;(s.classList.contains("sprint-game")||s.closest(".sprint-game"))&&e()}))}initAppView(){this.initStartPage(),M.AutoInit()}initStartPage(){this.body=document.querySelector(e),this.body.innerHTML=this.pageStructure()}gamePageTemplate(){return'\n    <div class="games-page">\n      <h3 class="games-page__header">Выберите <span>игру</span></h3>\n      <div class="games-page__buttons">\n        <a href="#games/audio-challenge" class="right deep-orange darken-1 waves-effect waves-light btn btn-large audio-challenge-game"><i class="large material-icons left">volume_up</i>Аудиовызов</a>\n        <a href="#games/sprint" class="right deep-orange darken-1 waves-effect waves-light btn btn-large sprint-game"><i class="large material-icons left">directions_run</i>Спринт</a>\n      </div>\n      <div class="games-page__image-block">\n        <img class="games-page__image" src="./assets/gamer.svg" alt="gamer">\n      </div>\n    </div>\n    '}pageStructure(){return`\n    <header class="header">\n      <nav>\n        <div class="nav-wrapper app-navigation red lighten-5">\n          <button class="switch-theme-button btn-floating btn-small waves-effect waves-light deep-orange darken-1"><i class="material-icons theme-icon">wb_sunny</i></button>\n          <a href="#home" class="switch-to-home-page brand-logo grey-text text-darken-4"><img class="hide-on-small-only school-logo"\n              src="./assets/rs-lang-logo.svg" alt="rs lang logo" title="RS Lang">RS-Lang</a>\n          <a href="#modal-log-in" class="modal-trigger right deep-orange darken-1 waves-effect waves-light btn login-button-header"><i class="material-icons left">exit_to_app</i>Вход</a>\n          <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i\n              class="material-icons grey-text text-darken-4">menu</i></a>\n          <ul class="nav-items right hide-on-med-and-down">\n            <li><a class="grey-text text-darken-4 textbook" href="#textbook">Учебник</a></li>\n            <li><a class="grey-text text-darken-4 games" href="#games">Игры</a></li>\n            <li><a class="grey-text text-darken-4 statistic" href="#statistic">Статистика</a></li>\n            <li><a class="grey-text text-darken-4 about" href="#about">О команде</a></li>\n          </ul>\n        </div>\n      </nav>\n      <ul class="sidenav sidenav-close app-navigation red lighten-5" id="mobile-demo">\n        <li><a class="grey-text text-darken-4 textbook" href="#textbook"><i class="material-icons">book</i>Учебник</a></li>\n        <li><a class="grey-text text-darken-4 games" href="#games"><i class="material-icons">games</i>Игры</a></li>\n        <li><a class="grey-text text-darken-4 statistic" href="#statistic"><i class="material-icons">assessment</i>Статистика</a></li>\n        <li><a class="grey-text text-darken-4 about" href="#about"><i class="material-icons">business_center</i>О команде</a></li>\n        <li><img class="hide-on-med-only mobile-school-logo" src="./assets/rs-lang-logo.svg" alt="rs lang logo"\n            title="RS Lang"></a></li>\n      </ul>\n\n      <div id="modal-log-in" class="modal">\n        <div class="modal-content">\n          <ul class="tabs center">\n            <li class="tab tab-modal"><a class="active" href="#log-in-swipe">Вход</a></li>\n            <li class="tab tab-modal"><a href="#registration-swipe">Регистрация</a></li>\n          </ul>\n\n          <div id="log-in-swipe" class="center">\n            <div class="input-field">\n              <i class="material-icons prefix">email</i>\n              <input id="email-log-in" type="email" class="validate">\n              <label for="email-log-in">Email</label>\n              <span class="helper-text" data-error="invalid email" data-success="perfectly"></span>\n            </div>\n            <div class="input-field">\n              <i class="material-icons prefix">lock_open</i>\n              <input id="password-log-in" type="password" minlength="8" class="validate">\n              <label for="password-log-in">Password</label>\n              <span class="helper-text" data-error="invalid password" data-success="perfectly"></span>\n            </div>\n            <a href="#" class="modal-close center log-in-button disabled deep-orange darken-1 waves-effect waves-light btn">Вход</a>\n          </div>\n\n          <div id="registration-swipe" class="center">\n            <div class="input-field">\n              <i class="material-icons prefix">account_circle</i>\n              <input id="user_name" type="text" minlength="2" class="validate">\n              <label for="user_name">Name</label>\n              <span class="helper-text" data-error="invalid name" data-success="perfectly"></span>\n            </div>\n            <div class="input-field">\n              <i class="material-icons prefix">email</i>\n              <input id="email-registration" type="email" class="validate">\n              <label for="email-registration">Email</label>\n              <span class="helper-text" data-error="invalid email" data-success="perfectly"></span>\n            </div>\n            <div class="input-field">\n              <i class="material-icons prefix">lock_open</i>\n              <input id="password-registration" type="password" minlength="8" class="validate">\n              <label for="password-registration">Password</label>\n              <span class="helper-text" data-error="invalid password" data-success="perfectly"></span>\n            </div>\n            <div class="input-field">\n              <i class="material-icons prefix">lock_open</i>\n              <input id="password-registration-confirm" type="password" minlength="8" class="validate">\n              <label for="password-registration-confirm">Confirm Password</label>\n              <span class="helper-text" data-error="invalid password" data-success="perfectly"></span>\n            </div>\n            <a href="#" class="modal-close center registration-button disabled deep-orange darken-1 waves-effect waves-light btn">Регистрация</a>\n          </div>\n\n        </div>\n        <div class="modal-footer">\n          <a href="#!" class="modal-close waves-effect waves-green btn-flat modal-close-footer-btn">Закрыть</a>\n        </div>\n      </div>\n\n    </header>\n\n    <main class="main">\n      <div class="main-wrapper">\n        ${this.homePage.homePageTemplate()}\n      </div>\n    </main>\n\n    <footer class="footer">\n      <div class="footer-wrapper footer-copyright grey-text text-darken-4">\n        <div class="school-link-block">\n          <span>© 2022</span>\n          <a href="https://rs.school/" target="_blank"><img class="rss_logo" src="./assets/rss_logo.svg"\n              alt="RS school logo"></a>\n        </div>\n        <div class="team-links">\n          <span></span>\n          <img class="github-logo" src="./assets/github-logo.png" alt="github logo">\n          <a class="grey-text text-darken-4 right" href="https://github.com/ilya2502" target="_blank">Илья</a>\n          <a class="grey-text text-darken-4 right" href="https://github.com/vitaliksamusenko" target="_blank">Виталий</a>\n          <a class="grey-text text-darken-4 right" href="https://github.com/mike-prybytkin" target="_blank">Михаил</a>\n        </div>\n      </div>\n    </footer>\n    `}},this.view.initAppView(),this.homePageController=new class{constructor(){this.renderHomePage=()=>{this.view.renderHomePage()},this.view=new w,this.view.listnerLogoButton(this.renderHomePage)}},this.audioCall=new class{constructor(e){this.init=()=>{this.view.renderStartPage(),this.view.addStartListeners(this.runStart)},this.runStart=e=>{this.view.addPreloader();const t=+e.currentTarget.id.slice(-1)-1;this.start(t)},this.playAudio=e=>{e.src="./assets/audio.svg",this.audio.addEventListener("ended",(()=>{e.src="./assets/play.svg"})),this.audio.play()},this.checkAnswer=e=>{const t=e.classList.contains("correct")?"correct-answer":"wrong-answer";this.view.hasAnswer=!0,this.model.updateStatistic(this.correctWord,t),this.view.hiddenIgnorance(),this.view.showCorrectAnswer(e,t),this.view.removeListener(),this.updateUserWord(this.correctWord,t)},this.nextPage=()=>{if(this.gamePage<this.countPages-1)this.gamePage+=1,this.createPage();else{const e=this.model.statistic.filter((e=>"wrong-answer"===e.answer)).length,t=this.model.statistic.filter((e=>"correct-answer"===e.answer)).length;this.view.renderStatisticPage(this.model.statistic,e,t),this.view.addStatisticListener(this.playAgain,this.goHomePage)}},this.addUnknownWord=()=>{this.view.hasAnswer||this.model.updateStatistic(this.correctWord,"wrong-answer"),this.nextPage()},this.playAgain=()=>{this.init()},this.goHomePage=()=>{this.renderHomePage()},this.view=new class{constructor(){this.hasAnswer=!1,this.baseUrl="https://rs-lang-prodaction.herokuapp.com"}renderStartPage(){this.container=document.querySelector(l.MainWrapper),this.container.innerHTML=this.startPageStructure()}addStartListeners(e){this.container.querySelectorAll(l.LevelButton).forEach((t=>{t.addEventListener("click",e)}))}renderGamePage(e,t){document.querySelector(l.FOOTER).style.display="none",this.hasAnswer=!1;const s=t[e];this.container=document.querySelector(l.MainWrapper),this.container.innerHTML=this.pageStructure(),document.querySelector(l.IMAGE_WORD).src=`${this.baseUrl}/${s.image}`,document.querySelectorAll(l.TEXT_VARIANT_CONTAINER).forEach(((s,i)=>{i===e&&s.classList.add("correct"),s.querySelector(l.TEXT_VARIANT).innerHTML=t[i].wordTranslate})),document.querySelector(l.TEXT_ANSWER).innerHTML=`${s.word} - ${s.wordTranslate}`}renderStatisticPage(e,t,s){this.container=document.querySelector(l.MainWrapper),this.container.innerHTML=this.statisticStructure(),this.container.querySelector(l.CountMistake).innerHTML=`${t}`,this.container.querySelector(l.CountSuccess).innerHTML=`${s}`,e.forEach((e=>{this.renderStatisticWord(e)}))}renderStatisticWord(e){const t=document.createElement("p"),s=document.createElement("span");s.classList.add(l.StatisticWordSpan.slice(1)),s.innerHTML=`${e.word}`;const i=document.createElement("span");i.classList.add(l.StatisticTranslateSpan.slice(1)),i.innerHTML=` - ${e.wordTranslate}`,t.append(s,i),"correct-answer"===e.answer?document.querySelector(l.SuccessStatisticContainer).append(t):document.querySelector(l.MistakeStatisticContainer).append(t)}addAudioListener(e){document.querySelectorAll(`${l.IMAGE_WORD_CONTAINER}, ${l.AUDIO_ICON_CONTAINER}`).forEach((t=>{t.addEventListener("click",(t=>{const s=t.target;e(s)}))}))}changeAudioImage(){const e=document.querySelector(l.ImageAudio);e&&(e.src="./assets/play.svg")}addKeyDownListener(e,t,s){document.addEventListener("keydown",(i=>{const r=this.getElementByKey(i.key);let n;if(r||" "===i.key)switch(i.key){case"1":case"2":case"3":this.hasAnswer||e(r);break;case"Enter":t();break;case" ":n=this.hasAnswer?document.querySelector(l.CorrectImageAudio):document.querySelector(l.ImageAudio),n&&s(n)}}))}getElementByKey(e){return document.querySelector(`#button${e}`)}addAnswerListener(e){document.querySelectorAll(`${l.TEXT_VARIANT_CONTAINER}`).forEach((t=>{t.addEventListener("click",(t=>{const s=t.currentTarget;e(s)}))}))}addStatisticListener(e,t){document.querySelector(l.StatisticPlayAgainButton).addEventListener("click",e),document.querySelector(l.StatisticHomePageButton).addEventListener("click",(()=>{t(),document.querySelector(l.FOOTER).style.display="block"}))}hiddenIgnorance(){document.querySelector(l.Ignorance).classList.add("hidden")}addNavigationListener(e){document.querySelector(l.Navigation).addEventListener("click",e)}addIgnoranceListener(e){document.querySelector(l.Ignorance).addEventListener("click",e)}showCorrectAnswer(e,t){document.querySelector(l.ImageAudio).classList.add("hidden"),document.querySelector(l.IMAGE_WORD).classList.add("visible-block"),document.querySelector(l.CorrectAnswerContainer).classList.add("visible-flex"),document.querySelector(l.Navigation).classList.add("visible-block"),e.classList.add(t)}removeListener(){document.querySelectorAll(l.TEXT_VARIANT_CONTAINER).forEach((e=>{e.disabled=!0}))}showToastMessage(){M.toast({html:"<span>Не найдены слова для изучения</span>"}),document.querySelector(i).style.backgroundColor="red"}pageStructure(){return'\n    <div class="audio-call-container">\n    <div class="studied-word-container">\n      <div class="image-word-container">\n        <img src="" alt="word-image" class="image-word">\n        <img src="./assets/audio.svg" alt="play-image" class="image-audio" id="button ">\n      </div>\n      <div class="correct-answer-container">\n        <div class="audio-icon-container">\n          <img src="./assets/play.svg" alt="audio-image" class="correct-image-audio">\n        </div>\n        <p class="text-answer">Answer</p>\n      </div>\n    </div>\n    <div class="variants-answers-container">\n      <button class="text-variant-container" id="button1">\n        <p class="text-variant">Varian1</p>\n      </button>\n      <button class="text-variant-container" id="button2">\n        <p class="text-variant">Varian2</p>\n      </button>\n      <button class="text-variant-container" id="button3">\n        <p class="text-variant">Varian3</p>\n      </button>\n    </div>\n    <div class="ignorance" id="buttonEnter">\n      <p class="text-navigation">Не знаю</p>\n    </div>\n    <div class="navigation">\n      <p class="text-navigation">Следующее слово</p>\n    </div>\n    </div>\n    '}statisticStructure(){return'\n    <div class="statistic-container">\n      <h2 class="statistic-title">Статистика игры</h2>\n      <div class="mistake-statistic-container">\n        <h3 class="mistake-title">Ошибок <span class="count-mistake"></span></h3>\n      </div>\n      <div class="success-statistic-container">\n        <h3 class="success-title">Правильных ответов <span class="count-success"></span></h3>\n      </div>\n      <div class="statistic-navigation-container">\n        <button class="statistic-play-again-button">Играть ещё раз</button>\n        <button class="statistic-home-page-button">На главную</button>\n      </div>\n    </div>\n    '}startPageStructure(){return'\n    <div class="start-page-container">\n      <h2 class="start-title">Выберите уровень сложности</h2>\n      <div class="difficulty-level-container">\n        <button class="difficulty-level" id="level1">1</button>\n        <button class="difficulty-level" id="level2">2</button>\n        <button class="difficulty-level" id="level3">3</button>\n        <button class="difficulty-level" id="level4">4</button>\n        <button class="difficulty-level" id="level5">5</button>\n        <button class="difficulty-level" id="level6">6</button>\n      </div>\n    </div>\n    <div class="game-controls">\n      <p><em>Управление:</em></p>\n      <p><strong>1, 2, 3</strong> - выбор слова</p>\n      <p><strong>Space</strong> - повторить аудио</p>\n      <p><strong>Enter</strong> - следующее слово / не знаю</p>\n    </div>\n    '}addPreloader(){this.container=document.querySelector(l.MainWrapper);const e=document.createElement("div");e.className="preloader-wrapper big active",e.innerHTML='\n    <div class="spinner-layer spinner-blue">\n      <div class="circle-clipper left">\n        <div class="circle"></div>\n      </div><div class="gap-patch">\n        <div class="circle"></div>\n      </div><div class="circle-clipper right">\n        <div class="circle"></div>\n    </div>\n\n    <div class="spinner-layer spinner-yellow">\n      <div class="circle-clipper left">\n        <div class="circle"></div>\n      </div><div class="gap-patch">\n        <div class="circle"></div>\n      </div><div class="circle-clipper right">\n        <div class="circle"></div>\n      </div>\n    </div>\n\n    <div class="spinner-layer spinner-red">\n      <div class="circle-clipper left">\n        <div class="circle"></div>\n      </div><div class="gap-patch">\n        <div class="circle"></div>\n      </div><div class="circle-clipper right">\n        <div class="circle"></div>\n      </div>\n    </div>\n    ',this.container.append(e)}},this.model=new class{constructor(){this.variantsWords=[],this.learnWords=[],this.userService=new p,this.wordsService=new f,this.countLearnWords=10,this.wordsPerPage=20,this.countVariantsAnswers=3}getWords(e,t){return S(this,void 0,void 0,(function*(){this.statistic=[],this.variantsWords=[],t?yield this.getWordsFromVocabulary(e,t):yield this.getWordsFromMenu(e)}))}getWordsFromVocabulary(e,t){return S(this,void 0,void 0,(function*(){if(this.hasToken()){const s=this.createFilterLearned(t-1),i=yield this.userService.getAggregatedWords(e,this.wordsPerPage,s);i&&(this.learnWords=i[0].paginatedResults.sort((()=>Math.random()-.5)).slice(0,this.countLearnWords),this.learnWords.length<this.countLearnWords&&(yield this.increaseAggregatedWords(e,t)))}else{const s=yield this.wordsService.getWords(e,t-1);s&&(this.learnWords=s.sort((()=>Math.random()-.5)).slice(0,this.countLearnWords))}const s=Array.from({length:30},((t,s)=>this.wordsService.getWords(e,s)));(yield Promise.all(s).then((e=>e.filter((e=>!!e))))).forEach((e=>{this.variantsWords=this.variantsWords.concat(e.filter((e=>!this.learnWords.find((t=>t.word===e.word)))))})),this.variantsWords.sort((()=>Math.random()-.5))}))}increaseAggregatedWords(e,t){return S(this,void 0,void 0,(function*(){const s=yield this.userService.getAggregatedWords(e,600,u);if(s){const e=s[0].paginatedResults.filter((e=>e.page<t-1)).sort(((e,t)=>t.page-e.page)),i=this.countLearnWords-this.learnWords.length;this.learnWords=e.length<i?this.learnWords.concat(e):this.learnWords.concat(e.slice(0,this.countLearnWords-this.learnWords.length))}}))}getWordsFromMenu(e){return S(this,void 0,void 0,(function*(){const t=this.getRandomInteger(0,29);if(this.hasToken()){const s=this.createFilterPage(t),i=yield this.userService.getAggregatedWords(e,this.countLearnWords,s);i&&(this.learnWords=i[0].paginatedResults.sort((()=>Math.random()-.5)).slice(0,this.countLearnWords))}else{const s=yield this.wordsService.getWords(e,t);s&&(this.learnWords=s.sort((()=>Math.random()-.5)).slice(0,this.countLearnWords))}const s=Array.from({length:30},((t,s)=>this.wordsService.getWords(e,s)));(yield Promise.all(s).then((e=>e.filter((e=>!!e))))).forEach((e=>{this.variantsWords=this.variantsWords.concat(e.filter((e=>!this.learnWords.find((t=>t.word===e.word)))))})),this.variantsWords.sort((()=>Math.random()-.5))}))}hasToken(){return this.userService.token}getRandomInteger(e,t){return Math.floor(Math.random()*(t-e+1))+e}createFilterLearned(e){return e?encodeURIComponent(`\n    {"$and":[{"page":${e}, "$or":[{"userWord":null}, {"userWord.optional.learned":false}]}]}`):u}createFilterPage(e){return encodeURIComponent(`{"page":${e}}`)}getWordsPage(e){const t=this.getRandomInteger(0,588);return[this.learnWords[e]].concat(this.variantsWords.slice(t,t+2))}updateStatistic(e,t){const s=e;s.answer=t,this.statistic.push(s)}},this.gamePage=0,this.countPages=0,this.audio=new Audio,this.audio.addEventListener("ended",(()=>{this.view.changeAudioImage()})),this.view.addKeyDownListener(this.checkAnswer,this.addUnknownWord,this.playAudio),this.renderHomePage=e}start(e,t){return b(this,void 0,void 0,(function*(){this.group=e,t&&(this.pageNumber=t),this.gamePage=0,yield this.model.getWords(e,t),this.countPages=this.model.learnWords.length,this.countPages?this.createPage():this.view.showToastMessage()}))}createPage(){const e=this.model.getWordsPage(this.gamePage);[this.correctWord]=e,e.sort((()=>Math.random()-.5));const t=e.findIndex((e=>e.id===this.correctWord.id));this.addSourceAudio(e[t].audio),this.view.renderGamePage(t,e),this.view.addAudioListener(this.playAudio),this.view.addAnswerListener(this.checkAnswer),this.view.addIgnoranceListener(this.addUnknownWord),this.view.addNavigationListener(this.nextPage)}addSourceAudio(e){this.audio.src=`${this.view.baseUrl}/${e}`,this.audio.play(),this.audio.addEventListener("ended",(()=>{this.view.changeAudioImage()}))}updateUserWord(e,t){return b(this,void 0,void 0,(function*(){let s;if(!this.model.userService.token)return void(s="id");s="_id";const i=yield this.model.userService.getUserWord(e[s]);if(i){const r=i.difficulty,n=i.optional,a=this.updateOptional(r,n,t);this.model.userService.updateUserWord(e[s],a.difficultyProperty,a.optional)}else{const i=this.createOptionalNewUserWord(t);this.model.userService.createNewUserWord(e[s],i)}}))}updateOptional(e,t,s){const i=t;return"wrong-answer"===s?(i.learned=!1,i.successAnswersSequence=0,i.wrongAttempt+=1,{difficultyProperty:e,optional:i}):"false"===e&&2===t.successAnswersSequence?(i.learned=!0,i.successAnswersSequence=3,i.successAttempt+=1,{difficultyProperty:e,optional:i}):"true"===e&&4===t.successAnswersSequence?(i.learned=!0,i.successAnswersSequence=5,i.successAttempt+=1,{difficultyProperty:"false",optional:i}):(i.successAnswersSequence+=1,i.successAttempt+=1,{difficultyProperty:e,optional:i})}createOptionalNewUserWord(e){return"correct-answer"===e?{learned:!1,successAnswersSequence:1,successAttempt:1,wrongAttempt:0}:{learned:!1,successAnswersSequence:0,successAttempt:0,wrongAttempt:1}}}(this.homePageController.renderHomePage),this.sprint=new class{constructor(e){this.init=()=>{this.view.renderStartPage(),this.view.addStartListeners(this.runStart)},this.runStart=e=>{this.view.addPreloader();const t=+e.currentTarget.id.slice(-1)-1;this.start(t)},this.playAudio=e=>{e.src="./assets/audio.svg",this.audioWord.addEventListener("ended",(()=>{e.src="./assets/play.svg"})),this.audioWord.play()},this.checkAnswer=e=>{if(this.isPause)return;this.view.removeListener();const t=e.classList.contains("correct")?"correct-answer":"wrong-answer";"correct-answer"===t?(this.audioGame.src="./assets/audio/piu.mp3",this.audioGame.play(),this.checkCountCorrectAnswers(),this.commonScore+=this.answerPoints):(this.countCorrectAnswer=0,this.answerPoints=10,this.audioGame.src="./assets/audio/mistake.mp3",this.audioGame.play(),this.view.clearCircles()),this.view.renderScore(this.commonScore,this.answerPoints),this.model.updateStatistic(this.correctWord,t),this.view.showCorrectAnswer(t),this.view.removeListener(),this.nextPage(),this.updateUserWord(this.correctWord,t)},this.nextPage=()=>{this.gamePage<this.countPages-1?(this.gamePage+=1,this.nextWord()):(clearInterval(this.timerId),this.runStatistic())},this.runStatistic=()=>{const e=this.model.statistic.filter((e=>"wrong-answer"===e.answer)).length,t=this.model.statistic.filter((e=>"correct-answer"===e.answer)).length;this.view.renderStatisticPage(this.model.statistic,e,t,this.commonScore),this.view.addStatisticListener(this.playAgain,this.goHomePage)},this.playAgain=()=>{this.init()},this.goHomePage=()=>{clearInterval(this.timerId),this.renderHomePage()},this.changeTime=()=>{!this.isPause&&document.querySelector(l.Timer)&&(this.time-=1,this.checkTime())},this.toggleAudio=()=>{let e;this.isPause=!this.isPause,this.isPause?(e="| |",this.view.removeListener()):(e=`${this.time}`,this.view.addVisibleButtons()),this.view.renderTimer(e)},this.view=new class{constructor(){this.baseUrl="https://rs-lang-prodaction.herokuapp.com"}renderStartPage(){this.container=document.querySelector(l.MainWrapper),this.container.innerHTML=this.startPageStructure()}addStartListeners(e){this.container.querySelectorAll(l.LevelButton).forEach((t=>{t.addEventListener("click",e)}))}renderGamePage(e,t){document.querySelector(l.FOOTER).style.display="none",this.container=document.querySelector(l.MainWrapper),this.container.innerHTML=this.pageStructure(),document.querySelector(l.TextWord).innerHTML=`${t[e].word}`,document.querySelector(l.TextTranslate).innerHTML=`${t[0].wordTranslate}`,0===e?document.querySelector(l.YesVariant).classList.add("correct"):document.querySelector(l.NoVariant).classList.add("correct")}renderNextWord(e,t){document.querySelector(l.MainGame).innerHTML=this.nextWordStructure(),document.querySelector(l.TextWord).innerHTML=`${t[e].word}`,document.querySelector(l.TextTranslate).innerHTML=`${t[0].wordTranslate}`,0===e?document.querySelector(l.YesVariant).classList.add("correct"):document.querySelector(l.NoVariant).classList.add("correct")}renderStatisticPage(e,t,s,i){this.container=document.querySelector(l.MainWrapper),this.container.innerHTML=this.statisticStructure(),this.container.querySelector(l.StatisticScore).innerHTML=`${i}`,this.container.querySelector(l.CountMistake).innerHTML=`${t}`,this.container.querySelector(l.CountSuccess).innerHTML=`${s}`,e.forEach((e=>{this.renderStatisticWord(e)}))}renderStatisticWord(e){const t=document.createElement("p"),s=document.createElement("span");s.classList.add(l.StatisticWordSpan.slice(1)),s.innerHTML=`${e.word}`;const i=document.createElement("span");i.classList.add(l.StatisticTranslateSpan.slice(1)),i.innerHTML=` - ${e.wordTranslate}`,t.append(s,i),"correct-answer"===e.answer?document.querySelector(l.SuccessStatisticContainer).append(t):document.querySelector(l.MistakeStatisticContainer).append(t)}addAudioListener(e){document.querySelector(l.AudioImageContainer).addEventListener("click",(t=>{const s=t.target;e(s)}))}changeAudioImage(){const e=document.querySelector(l.SprintAudioIcon);e&&(e.src="./assets/play.svg")}addTimerListener(e){document.querySelector(l.Timer).addEventListener("click",e)}renderTimer(e){document.querySelector(l.Timer).innerHTML=e}addKeyDownListener(e,t){document.addEventListener("keydown",(s=>{const i=document.querySelector(`#${s.code}`);if(i||"Space"===s.code){const r=document.querySelector(l.SprintContainer);switch(r.classList.remove("border-animation-correct"),r.classList.remove("border-animation-wrong"),s.code){case"ArrowLeft":case"ArrowRight":e(i);break;case"Space":t()}}}))}addAnswerListener(e){document.querySelectorAll(l.ButtonVariant).forEach((t=>{t.addEventListener("click",(t=>{const s=document.querySelector(l.SprintContainer);s.classList.remove("border-animation-correct"),s.classList.remove("border-animation-wrong");const i=t.currentTarget;e(i)}))}))}addCrossListener(e){document.querySelector(l.CrossContainer).addEventListener("click",e)}addStatisticListener(e,t){document.querySelector(l.StatisticPlayAgainButton).addEventListener("click",e),document.querySelector(l.StatisticHomePageButton).addEventListener("click",(()=>{t(),document.querySelector(l.FOOTER).style.display="block"}))}showCorrectAnswer(e){const t=document.querySelector(l.SprintContainer);"correct-answer"===e?t.classList.add("border-animation-correct"):t.classList.add("border-animation-wrong")}removeListener(){document.querySelectorAll(l.ButtonVariant).forEach((e=>{e.disabled=!0}))}addVisibleButtons(){document.querySelectorAll(l.ButtonVariant).forEach((e=>{e.disabled=!1}))}showToastMessage(){M.toast({html:"<span>Не найдены слова для изучения</span>"}),document.querySelector(i).style.backgroundColor="red"}renderTime(e){const t=document.querySelector(l.Timer);t&&(t.innerHTML=`${e}`)}renderScore(e,t){const s=document.querySelector(l.Score);s&&(s.innerHTML=`${e}`);const i=document.querySelector(l.CountPoints);i&&(i.innerHTML=`${t}`)}showCorrectCircle(e){const t=document.querySelector(`#circle${e}`);t&&(t.classList.add("correct-circle"),t.innerHTML="&#10003;")}clearCircles(){document.querySelectorAll(l.AnswerCircle).forEach((e=>{e.classList.remove("correct-circle"),e.innerHTML=""}))}pageStructure(){return'\n    <div class="game-tools-container">\n    <div class="timer">60</div>\n    <div class="score">0</div>\n    <div class="cross-container">X</div>\n  </div>\n  <div class="sprint-container">\n    <div class="header-game">\n      <div class="answer-circle-container">\n        <div class="answer-circle" id="circle1"></div>\n        <div class="answer-circle" id="circle2"></div>\n        <div class="answer-circle" id="circle3"></div>\n        <p class="text-points">+<span class="count-points">10</span> очков за слово</p>\n      </div>\n      <div class="audio-image-container">\n        <img src="./assets/play.svg" alt="audio-image" class="sprint-audio-icon">\n      </div>\n    </div>\n    <div class="main-game">\n      <div class="study-sprint-container">\n        <div class="word-container">\n          <p class="text-word">Word</p>\n          <p class="text-translate">translate</p>\n        </div>\n      </div>\n      <div class="variants-sprint-container">\n        <button class="no-variant button-variant" id="ArrowLeft">\n          <p class="sprint-text-variant">&larr; Неверно</p>\n        </button>\n        <button class="yes-variant button-variant" id="ArrowRight">\n          <p class="sprint-text-variant">Верно &rarr;</p>\n        </button>\n      </div>\n    </div>\n  </div>\n    '}nextWordStructure(){return'\n      <div class="study-sprint-container">\n        <div class="word-container">\n          <p class="text-word">Word</p>\n          <p class="text-translate">translate</p>\n        </div>\n      </div>\n      <div class="variants-sprint-container">\n        <button class="no-variant button-variant" id="ArrowLeft">\n          <p class="sprint-text-variant">&larr; Неверно</p>\n        </button>\n        <button class="yes-variant button-variant" id="ArrowRight">\n          <p class="sprint-text-variant">Верно &rarr;</p>\n        </button>\n      </div>\n    '}statisticStructure(){return'\n    <div class="statistic-container">\n      <h1 class="statistic-title">Статистика игры</h1>\n      <h3 class="score-title">Заработанно баллов <span class="statistic-score"></span></h3>\n      <div class="mistake-statistic-container">\n        <h3 class="mistake-title">Ошибок <span class="count-mistake"></span></h3>\n      </div>\n      <div class="success-statistic-container">\n        <h3 class="success-title">Правильных ответов <span class="count-success"></span></h3>\n      </div>\n      <div class="statistic-navigation-container">\n        <button class="statistic-play-again-button">Играть ещё раз</button>\n        <button class="statistic-home-page-button">На главную</button>\n      </div>\n    </div>\n    '}startPageStructure(){return'\n    <div class="start-page-container">\n      <h1 class="start-title">Выберите уровень сложности</h1>\n      <div class="difficulty-level-container">\n        <button class="difficulty-level" id="level1">1</button>\n        <button class="difficulty-level" id="level2">2</button>\n        <button class="difficulty-level" id="level3">3</button>\n        <button class="difficulty-level" id="level4">4</button>\n        <button class="difficulty-level" id="level5">5</button>\n        <button class="difficulty-level" id="level6">6</button>\n      </div>\n    </div>\n    <div class="game-controls">\n      <p><em>Управление:</em></p>\n      <p><strong>&#129136; , &#129138;</strong> - выбор ответа</p>\n      <p><strong>Space</strong> - пауза, отмена паузы</p>\n    </div>\n    '}addPreloader(){this.container=document.querySelector(l.MainWrapper);const e=document.createElement("div");e.className="preloader-wrapper big active",e.innerHTML='\n    <div class="spinner-layer spinner-blue">\n      <div class="circle-clipper left">\n        <div class="circle"></div>\n      </div><div class="gap-patch">\n        <div class="circle"></div>\n      </div><div class="circle-clipper right">\n        <div class="circle"></div>\n    </div>\n\n    <div class="spinner-layer spinner-yellow">\n      <div class="circle-clipper left">\n        <div class="circle"></div>\n      </div><div class="gap-patch">\n        <div class="circle"></div>\n      </div><div class="circle-clipper right">\n        <div class="circle"></div>\n      </div>\n    </div>\n\n    <div class="spinner-layer spinner-red">\n      <div class="circle-clipper left">\n        <div class="circle"></div>\n      </div><div class="gap-patch">\n        <div class="circle"></div>\n      </div><div class="circle-clipper right">\n        <div class="circle"></div>\n      </div>\n    </div>\n    ',this.container.append(e)}},this.model=new class{constructor(){this.variantsWords=[],this.learnWords=[],this.userService=new p,this.wordsService=new f,this.countLearnWords=600,this.wordsPerPage=20,this.countVariantsAnswers=3}getWords(e,t){return L(this,void 0,void 0,(function*(){this.statistic=[],this.variantsWords=[],t?yield this.getWordsFromVocabulary(e,t):yield this.getWordsFromMenu(e)}))}getWordsFromVocabulary(e,t){return L(this,void 0,void 0,(function*(){if(this.hasToken()){const s=this.createFilterLearned(t-1),i=yield this.userService.getAggregatedWords(e,this.wordsPerPage,s);i&&(this.learnWords=i[0].paginatedResults.sort((()=>Math.random()-.5)),this.learnWords.length<this.countLearnWords&&(yield this.increaseAggregatedWords(e,t)));const r=yield this.userService.getAggregatedWords(e,600);r&&(this.variantsWords=r[0].paginatedResults.sort((()=>Math.random()-.5)))}else{const s=yield this.wordsService.getWords(e,t-1);s&&(this.learnWords=s.sort((()=>Math.random()-.5)).slice(0,this.countLearnWords));const i=Array.from({length:30},((t,s)=>this.wordsService.getWords(e,s))),r=yield Promise.all(i).then((e=>e.filter((e=>!!e))));r.forEach((e=>{this.variantsWords=this.variantsWords.concat(e)})),r.filter((e=>e[0].page<t-1)).sort(((e,t)=>t[0].page-e[0].page)).map((e=>e.sort((()=>Math.random()-.5)))).forEach((e=>{this.learnWords=this.learnWords.concat(e)}))}}))}hasToken(){return this.userService.token}increaseAggregatedWords(e,t){return L(this,void 0,void 0,(function*(){const s=yield this.userService.getAggregatedWords(e,600,u);if(s){const e=s[0].paginatedResults.filter((e=>e.page<t-1)).sort(((e,t)=>t.page-e.page)),i=this.countLearnWords-this.learnWords.length;this.learnWords=e.length<i?this.learnWords.concat(e):this.learnWords.concat(e.slice(0,this.countLearnWords-this.learnWords.length))}}))}getWordsFromMenu(e){return L(this,void 0,void 0,(function*(){if(this.hasToken()){const t=yield this.userService.getAggregatedWords(e,this.countLearnWords);t&&(this.variantsWords=t[0].paginatedResults.sort((()=>Math.random()-.5)),this.learnWords=this.variantsWords)}else{const t=Array.from({length:30},((t,s)=>this.wordsService.getWords(e,s)));(yield Promise.all(t).then((e=>e.filter((e=>!!e))))).forEach((e=>{this.variantsWords=this.variantsWords.concat(e).sort((()=>Math.random()-.5)),this.learnWords=this.variantsWords}))}this.variantsWords.sort((()=>Math.random()-.5))}))}getRandomInteger(e,t){return Math.floor(Math.random()*(t-e+1))+e}createFilterLearned(e){return e?encodeURIComponent(`\n    {"$and":[{"page":${e}, "$or":[{"userWord":null}, {"userWord.optional.learned":false}]}]}`):u}getWordsPage(e){let t=this.getRandomInteger(0,598);for(;this.learnWords[e].word===this.variantsWords[t].word;)t=this.getRandomInteger(0,598);return[this.learnWords[e]].concat(this.variantsWords[t])}updateStatistic(e,t){const s=e;s.answer=t,this.statistic.push(s)}},this.gamePage=0,this.countPages=0,this.audioGame=new Audio,this.audioWord=new Audio,this.audioTimer=new Audio,this.audioFinal=new Audio,this.audioTimer.src="./assets/audio/timer.mp3",this.audioFinal.src="./assets/audio/final.mp3",this.time=60,this.commonScore=0,this.answerPoints=10,this.countCorrectAnswer=0,this.view.addKeyDownListener(this.checkAnswer,this.toggleAudio),this.isPause=!1,this.renderHomePage=e}start(e,t){return k(this,void 0,void 0,(function*(){this.time=60,this.commonScore=0,this.answerPoints=10,this.countCorrectAnswer=0,clearInterval(this.timerId),this.group=e,t&&(this.pageNumber=t),this.gamePage=0,yield this.model.getWords(e,t),this.countPages=this.model.learnWords.length,this.countPages?this.createPage():this.view.showToastMessage()}))}createPage(){const e=this.model.getWordsPage(this.gamePage);[this.correctWord]=e,e.sort((()=>Math.random()-.5));const t=e.findIndex((e=>e.word===this.correctWord.word));this.addSourceAudio(e[t].audio),this.view.renderGamePage(t,e),this.view.addAudioListener(this.playAudio),this.view.addAnswerListener(this.checkAnswer),this.view.addTimerListener(this.toggleAudio),this.view.addCrossListener(this.goHomePage),this.time=60,this.timerId=setInterval(this.changeTime,1e3)}nextWord(){const e=this.model.getWordsPage(this.gamePage);[this.correctWord]=e,e.sort((()=>Math.random()-.5));const t=e.findIndex((e=>e.word===this.correctWord.word));this.addSourceAudio(e[t].audio),this.view.renderNextWord(t,e),this.view.addAudioListener(this.playAudio),this.view.addAnswerListener(this.checkAnswer)}addSourceAudio(e){this.audioWord.src=`${this.view.baseUrl}/${e}`}updateUserWord(e,t){return k(this,void 0,void 0,(function*(){let s;if(!this.model.userService.token)return void(s="id");s="_id";const i=yield this.model.userService.getUserWord(e[s]);if(i){const r=i.difficulty,n=i.optional,a=this.updateOptional(r,n,t);this.model.userService.updateUserWord(e[s],a.difficultyProperty,a.optional)}else{const i=this.createOptionalNewUserWord(t);this.model.userService.createNewUserWord(e[s],i)}}))}updateOptional(e,t,s){const i=t;return"wrong-answer"===s?(i.learned=!1,i.successAnswersSequence=0,i.wrongAttempt+=1,{difficultyProperty:e,optional:i}):"false"===e&&2===t.successAnswersSequence?(i.learned=!0,i.successAnswersSequence=3,i.successAttempt+=1,{difficultyProperty:e,optional:i}):"true"===e&&4===t.successAnswersSequence?(i.learned=!0,i.successAnswersSequence=5,i.successAttempt+=1,{difficultyProperty:"false",optional:i}):(i.successAnswersSequence+=1,i.successAttempt+=1,{difficultyProperty:e,optional:i})}createOptionalNewUserWord(e){return"correct-answer"===e?{learned:!1,successAnswersSequence:1,successAttempt:1,wrongAttempt:0}:{learned:!1,successAnswersSequence:0,successAttempt:0,wrongAttempt:1}}checkCountCorrectAnswers(){3===this.countCorrectAnswer?(this.countCorrectAnswer=0,this.answerPoints*=2,this.view.clearCircles()):(this.countCorrectAnswer+=1,this.view.showCorrectCircle(`${this.countCorrectAnswer}`))}checkTime(){this.time<0?(this.audioFinal.play(),clearInterval(this.timerId),this.runStatistic()):(this.audioTimer.play(),this.view.renderTime(this.time))}}(this.homePageController.renderHomePage),this.authorizeController=new class{constructor(e,t){this.registrationUser=e=>{this.model.createUser(e.email,e.password,e.name).then((e=>{e?this.view.showToastMessage(`${e.name}, Вы успешно зарегистрировались!`,"green"):this.view.showToastMessage("Извините, такой email уже зарегистрирован","red")}))},this.logInUser=e=>{this.model.logInUser(e.email,e.password).then((e=>{e?(this.view.showToastMessage(`Здравствуйте ${e.name}!`,"green"),this.model.setLocalStorage(e),this.view.renderLoginUser(e.name),this.audioCall.model.userService.writeUserData(e),this.sprint.model.userService.writeUserData(e)):this.view.showToastMessage("Упс, такого пользователя не существует...","red"),document.location.reload()}))},this.logOutUser=()=>{this.model.removeLocalStorage(),this.audioCall.model.userService.removeUserData()},this.view=new class{constructor(){this.userName=document.getElementById("user_name"),this.emailRegistration=document.getElementById("email-registration"),this.passwordRegistration=document.getElementById("password-registration"),this.passwordRegistrationConf=document.getElementById("password-registration-confirm"),this.emailLogIn=document.getElementById("email-log-in"),this.passwordLogIn=document.getElementById("password-log-in"),this.loginButtonHeader=document.querySelector(".login-button-header"),this.logInButton=document.querySelector(".log-in-button"),this.registrationButton=document.querySelector(".registration-button"),this.modalWindow=document.getElementById("modal-log-in")}clearFormElements(){this.loginButtonHeader.addEventListener("click",(()=>{this.clearRegistrationForm(),this.clearLogInForm()}))}registrationUser(e){this.registrationButton.addEventListener("click",(()=>{e({email:this.emailRegistration.value,password:this.passwordRegistration.value,name:this.userName.value}),this.clearRegistrationForm()}))}logInUser(e){this.logInButton.addEventListener("click",(()=>{e({email:this.emailLogIn.value,password:this.passwordLogIn.value}),this.clearLogInForm()}))}renderLoginUser(e){this.loginButtonHeader.innerHTML='<i class="material-icons left">account_box</i>выход',this.loginButtonHeader.classList.remove("modal-trigger"),this.loginButtonHeader.classList.add(s,"tooltipped"),this.loginButtonHeader.setAttribute("data-position","bottom"),this.loginButtonHeader.setAttribute("data-tooltip",`${e}, Вы хотите выйти?`),M.AutoInit()}renderLogoutUser(e){this.loginButtonHeader.addEventListener("click",(()=>{this.loginButtonHeader.classList.contains(s)&&(e(),document.location.reload())}))}checkRegistrationForm(){this.modalWindow.addEventListener("focusout",(()=>{this.userName.classList.contains("valid")&&this.emailRegistration.classList.contains("valid")&&this.passwordRegistration.classList.contains("valid")&&this.passwordRegistrationConf.value===this.passwordRegistration.value?this.registrationButton.classList.remove("disabled"):this.registrationButton.classList.add("disabled")}))}checkLogInForm(){this.modalWindow.addEventListener("focusout",(()=>{this.emailLogIn.classList.contains("valid")&&this.passwordLogIn.classList.contains("valid")?this.logInButton.classList.remove("disabled"):this.logInButton.classList.add("disabled")}))}showToastMessage(e,t){const s=`<span>${e}</span>`;M.toast({html:s}),document.querySelector(i).style.backgroundColor=t}clearRegistrationForm(){this.userName.value="",this.emailRegistration.value="",this.passwordRegistration.value="",this.passwordRegistrationConf.value="",this.passwordRegistration.value="",this.userName.classList.remove("valid"),this.emailRegistration.classList.remove("valid"),this.passwordRegistration.classList.remove("valid"),this.passwordRegistrationConf.classList.remove("valid"),this.passwordRegistration.classList.remove("valid"),this.userName.classList.remove("invalid"),this.emailRegistration.classList.remove("invalid"),this.passwordRegistration.classList.remove("invalid"),this.passwordRegistrationConf.classList.remove("invalid"),this.passwordRegistration.classList.remove("invalid"),this.registrationButton.classList.add("disabled")}clearLogInForm(){this.emailLogIn.value="",this.passwordLogIn.value="",this.emailLogIn.classList.remove("valid"),this.passwordLogIn.classList.remove("valid"),this.emailLogIn.classList.remove("invalid"),this.passwordLogIn.classList.remove("invalid"),this.logInButton.classList.add("disabled")}closeModalWindow(){document.querySelector(".modal-close-footer-btn").addEventListener("click",(()=>{this.clearRegistrationForm(),this.clearLogInForm()}))}},this.model=new class{constructor(){this.localStorageService=new h,this.userService=new p}createUser(e,t,s){return this.userService.createUser(e,t,s)}logInUser(e,t){return this.userService.loginUser(e,t)}setLocalStorage(e){this.localStorageService.setItemLocalStorage("user",e)}removeLocalStorage(){this.localStorageService.removeItemLocalStorage("user")}getLocalStorage(){return this.localStorageService.getItemLocalStorage("user")}},this.audioCall=e,this.sprint=t}init(){this.view.registrationUser(this.registrationUser),this.view.logInUser(this.logInUser),this.view.renderLogoutUser(this.logOutUser),this.view.checkRegistrationForm(),this.view.checkLogInForm(),this.view.clearFormElements(),this.view.closeModalWindow(),this.checkLogInUser()}checkLogInUser(){const e=this.model.getLocalStorage();e&&this.view.renderLoginUser(e.name)}}(this.audioCall,this.sprint),this.switchThemeController=new class{constructor(){this.switchTheme=()=>{this.model.getLocalStorage()?(this.view.darkTheme(),this.model.removeLocalStorage()):(this.view.lightTheme(),this.model.setLocalStorage(!0))},this.view=new class{constructor(){this.body=document.querySelector(e),this.appText=document.getElementsByClassName("grey-text"),this.navAndBurger=document.getElementsByClassName("app-navigation")}buttonListener(e){document.querySelector(".switch-theme-button").addEventListener("click",(()=>{e()}))}darkTheme(){this.body.classList.add(d);for(let e=0;e<this.appText.length;e+=1)this.appText[e].classList.remove(n),this.appText[e].classList.add(a);for(let e=0;e<this.navAndBurger.length;e+=1)this.navAndBurger[e].classList.remove(`${o[0]}`,`${o[1]}`),this.navAndBurger[e].classList.add(`${c[0]}`,`${c[1]}`);document.querySelector(r).textContent="brightness_3"}lightTheme(){this.body.classList.contains(d)&&this.body.classList.remove(d);for(let e=0;e<this.appText.length;e+=1)this.appText[e].classList.remove(a),this.appText[e].classList.add(n);for(let e=0;e<this.navAndBurger.length;e+=1)this.navAndBurger[e].classList.remove(`${c[0]}`,`${c[1]}`),this.navAndBurger[e].classList.add(`${o[0]}`,`${o[1]}`);document.querySelector(r).textContent="wb_sunny"}},this.model=new class{constructor(){this.localStorageService=new h}setLocalStorage(e){this.localStorageService.setItemLocalStorage("dark-theme",e)}removeLocalStorage(){this.localStorageService.removeItemLocalStorage("dark-theme")}getLocalStorage(){return this.localStorageService.getItemLocalStorage("dark-theme")}}}init(){this.view.buttonListener(this.switchTheme),this.checkTheme()}checkTheme(){this.model.getLocalStorage()||this.view.darkTheme()}},this.view.listnerGamesButton(),this.view.callAudioChallengeGame(this.audioCall.init),this.view.callSprintGame(this.sprint.init),this.aboutPageController=new class{constructor(){this.view=new class{constructor(){this.aboutPageTemplate=()=>'\n    <h3 class="our-team-header">Наша <span class="team">команда</span></h3>\n    <div class="slider">\n      <ul class="slides">\n        <li class="teammate-1">\n          <div class="caption center-align">\n            <img class="img teammate-1__image" src="./assets/team/ilya.png" alt="Ilya">\n            <span class="teammate-name"><span class="name">Илья</span> Гавричков</span>\n            <h5 class="contribution">Team Lead проекта.</h5>\n            <h5 class="contribution">Разработчик игр Аудиовызов и Спринт.</h5>\n            <h5 class="contribution">Создатель сервиса запросов на сервер.</h5>\n            <p class="teammate-github ilya"><a class="center" href="https://github.com/ilya2502" target="_blank">GitHub</a></p>\n          </div>\n        </li>\n        <li class="teammate-2">\n          <div class="caption left-align">\n            <img class="img teammate-2__image" src="./assets/team/mihail.jpg" alt="Mihail">\n            <span class="teammate-name"><span class="name">Михаил</span> Прибыткин</span>\n            <h5 class="contribution">Внешний вид приложения.</h5>\n            <h5 class="contribution">Регистрация/вход пользователя.</h5>\n            <h5 class="contribution">Светлая/темная темы.</h5>\n            <p class="teammate-github mihail"><a class="left" href="https://github.com/mike-prybytkin" target="_blank">GitHub</a></p>\n          </div>\n        </li>\n        <li class="teammate-3">\n          <div class="caption right-align">\n            <img class="img teammate-3__image" src="./assets/team/vitaliy.png" alt="Vitaliy">\n            <span class="teammate-name"><span class="name">Виталий</span> Самусенко</span>\n            <h5 class="contribution">Реализация электронного учебника.</h5>\n            <h5 class="contribution">Отображение списка слов.</h5>\n            <p class="teammate-github vitaliy"><a class="right" href="https://github.com/vitaliksamusenko" target="_blank">GitHub</a></p>\n          </div>\n        </li>\n      </ul>\n    </div>\n    ',this.aboutButtons=document.querySelectorAll(".about"),this.mainWrapper=document.querySelector(t)}aboutButtonsListener(e){for(let t=0;t<this.aboutButtons.length;t+=1)this.aboutButtons[t].addEventListener("click",(()=>{const t=e();this.mainWrapper.innerHTML=t;const s=document.querySelectorAll(".slider");M.Slider.init(s,{})}))}},this.view.aboutButtonsListener(this.view.aboutPageTemplate)}},this.textbook=new class{constructor(){this.userService=new p,this.textbookView=new T,this.textbookModel=new class{constructor(){this.currPage=0,this.currGroup=0,this.minPage=0,this.maxPage=29,this.localStorageService=new h,this.textbookView=new T,this.wordsService=new f,this.userService=new p,this.user=this.localStorageService.getItemLocalStorage("user")}getWords(e=0,t=0){return P(this,void 0,void 0,(function*(){return yield this.wordsService.getWords(e,t)}))}getUserDifficultWord(){return P(this,void 0,void 0,(function*(){return yield this.userService.getAllUserWords1(this.user.userId,this.user.token)}))}getWordsFromDifficult(){return P(this,void 0,void 0,(function*(){const e=yield this.getUserDifficultWord(),t=[];return e.forEach((e=>{e.optional.learned||t.push(this.wordsService.getWordById(e.wordId))})),t}))}}}in(){document.querySelectorAll(".textbook").forEach((e=>{e.addEventListener("click",(()=>{this.init()}))}))}init(){this.textbookView.renderBaseStructure(),this.textbookView.initializeGroupDropdown(6),this.textbookView.initializePageDropdown(30),this.changeGroup(),this.changePage(),this.nextPage(),this.prevPage(),this.textbookView.updatePage(this.textbookModel.currGroup,this.textbookModel.currPage,this.textbookModel.getWords(this.textbookModel.currGroup,this.textbookModel.currPage)),document.querySelector(".game__btn-audiocall").addEventListener("click",(()=>{this.audiocall.start(this.getGroup(),this.getPage()+1)})),document.querySelector(".game__btn-sprint").addEventListener("click",(()=>{this.sprint.start(this.getGroup(),this.getPage()+1)}))}getGroup(){return this.textbookModel.currGroup}getPage(){return this.textbookModel.currPage}nextPage(){document.querySelector(".next-btn").addEventListener("click",(()=>{this.textbookModel.currPage<this.textbookModel.maxPage&&(this.textbookModel.currPage+=1,this.textbookView.updatePage(this.textbookModel.currGroup,this.textbookModel.currPage,this.textbookModel.getWords(this.textbookModel.currGroup,this.textbookModel.currPage)))}))}prevPage(){document.querySelector(".prev-btn").addEventListener("click",(()=>{this.textbookModel.currPage>this.textbookModel.minPage&&(this.textbookModel.currPage-=1,this.textbookView.updatePage(this.textbookModel.currGroup,this.textbookModel.currPage,this.textbookModel.getWords(this.textbookModel.currGroup,this.textbookModel.currPage)))}))}changeGroup(){document.querySelectorAll(".group__item").forEach((e=>{e.addEventListener("click",(()=>{var t;this.textbookModel.currGroup=Number(null===(t=e.textContent)||void 0===t?void 0:t.split(" ")[1])-1,this.textbookModel.currPage=0,this.textbookView.updatePage(this.textbookModel.currGroup,this.textbookModel.currPage,this.textbookModel.getWords(this.textbookModel.currGroup,this.textbookModel.currPage))}))})),this.textbookView.user&&document.querySelector(".group__item_difficult").addEventListener("click",(()=>{return e=this,t=void 0,i=function*(){this.textbookView.renderDifficultPage(yield this.textbookModel.getWordsFromDifficult()),this.textbookView.changeControlsCaptionForDifficult()},new((s=void 0)||(s=Promise))((function(r,n){function a(e){try{c(i.next(e))}catch(e){n(e)}}function o(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}c((i=i.apply(e,t||[])).next())}));var e,t,s,i}))}changePage(){document.querySelectorAll(".page__item").forEach((e=>{e.addEventListener("click",(()=>{var t;this.textbookModel.currPage=Number(null===(t=e.textContent)||void 0===t?void 0:t.split(" ")[1])-1,this.textbookView.updatePage(this.textbookModel.currGroup,this.textbookModel.currPage,this.textbookModel.getWords(this.textbookModel.currGroup,this.textbookModel.currPage))}))}))}},this.textbook.audiocall=this.audioCall,this.textbook.sprint=this.sprint,this.statisticPageController=new class{constructor(){this.renderStatisticPage=()=>this.model.checkAuthorizeUser()?this.view.statisticUserPageTemplate():this.view.statisticAnonimPageTemplate(),this.view=new class{constructor(){this.statisticUserPageTemplate=()=>'\n    <h4 class="statistic-header">Извините, статистика временно не доступна</h4>\n    ',this.statisticAnonimPageTemplate=()=>'\n    <h4 class="statistic-header">Статистика не доступна для незарегистрированных пользователей.</h4>\n    ',this.statisticButtons=document.querySelectorAll(".statistic"),this.mainWrapper=document.querySelector(t)}statisticButtonsListener(e){for(let t=0;t<this.statisticButtons.length;t+=1)this.statisticButtons[t].addEventListener("click",(()=>{const t=e();this.mainWrapper.innerHTML=t+'<img class="statistic-image" src="./assets/celebration.svg" alt="celebration">'}))}},this.model=new class{constructor(){this.localStorageService=new h}checkAuthorizeUser(){return this.localStorageService.getItemLocalStorage("user")}},this.view.statisticButtonsListener(this.renderStatisticPage)}}}initApp(){this.authorizeController.init(),this.switchThemeController.init(),this.textbook.in()}}).initApp()})();